export default class EventEmitter{constructor(){this.events={},this.eventsCount=0}addListener(e,t,n,s=!1){if("function"!=typeof t)throw new TypeError("The callback must be a function");let c=new Listener(t,n||this,s);return this.events[e]?this.events[e].callback?this.events[e]=[this.events[e],c]:this.events[e].push(c):(this.events[e]=c,this.eventsCount++),this}removeEvent(e){return 0==--this.eventsCount?this.events={}:delete this.events[e],this}eventNames(){let e,t,n=[];if(0===this.eventsCount)return n;for(t in e=this.events)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n}listeners(e){let t=[],n=this.events[e];if(!n)return[];if(n.callback)return[n.callback];for(let e=0;e<n.length;e++)t[e]=n[e].callback;return t}listenerCount(e){let t=this.events[e];return t?t.callback?1:t.length:0}emit(e,t,n,s,c,l){if(!this.events[e])return!1;let r,a,i=this.events[e],o=arguments.length;if(i.callback){switch(i.once&&this.removeListener(e,i.callback,void 0,!0),o){case 1:return i.callback.call(i.context),!0;case 2:return i.callback.call(i.context,t),!0;case 3:return i.callback.call(i.context,t,n),!0;case 4:return i.callback.call(i.context,t,n,s),!0;case 5:return i.callback.call(i.context,t,n,s,c),!0;case 6:return i.callback.call(i.context,t,n,s,c,l),!0}for(a=1,r=new Array(o-1);a<o;a++)r[a-1]=arguments[a];i.callback.apply(i.context,r)}else{let c,l=i.length;for(a=0;a<l;a++)switch(i[a].once&&this.removeListener(e,i[a].callback,void 0,!0),o){case 1:i[a].callback.call(i[a].context);break;case 2:i[a].callback.call(i[a].context,t);break;case 3:i[a].callback.call(i[a].context,t,n);break;case 4:i[a].callback.call(i[a].context,t,n,s);break;default:if(!r)for(c=1,r=new Array(o-1);c<o;c++)r[c-1]=arguments[c];i[a].callback.apply(i[a].context,r)}}return!0}on(e,t,n){return this.addListener(e,t,n,!1)}once(e,t,n){return this.addListener(e,t,n,!0)}removeListener(e,t,n,s){let c=[];if(!this.events[e])return this;if(!t)return this.removeEvent(e),this;let l=this.events[e];if(l.callback)l.callback!==t||s&&!l.once||n&&l.context!==n||this.removeEvent(e);else{for(let e=0,c=[],r=l.length;e<r;e++)(l[e].callback!==t||s&&!l[e].once||n&&l[e].context!==n)&&c.push(l[e]);c.length?this.events[e]=1===c.length?c[0]:c:this.removeEvent(e)}return this}off(e,t,n,s){return this.removeListener(e,t,n,s)}removeAllListeners(e){return e?this.events[e]&&this.removeEvent(e):(this.events={},this.eventsCount=0),this}}export class Listener{constructor(e,t,n=!1){this.callback=e,this.context=t,this.once=!0===n||!1}}
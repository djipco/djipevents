class t{constructor(){this.events={},this.suspended=!1}on(t,s,n={}){if("function"!=typeof s)throw new TypeError("The callback must be a function");const i={context:this,duration:1/0,data:void 0,prepend:!1,count:1/0};n=Object.assign({},i,n);const c=new e(t,this,s,n);return n.duration!==1/0&&setTimeout(()=>c.remove(),n.duration),this.events[t]||(this.events[t]=[]),n.prepend?this.events[t].unshift(c):this.events[t].push(c),c}static get ANY_EVENT(){return Symbol.for("Any event")}hasListener(t){return!!(this.events[t]&&this.events[t].length>0)}get eventNames(){return Object.keys(this.events)}getListeners(t){return this.events[t]||[]}suspend(t){this.getListeners(t).forEach(t=>{t.suspended=!0})}unsuspend(t){this.getListeners(t).forEach(t=>{t.suspended=!1})}getListenerCount(t){return this.getListeners(t).length}emit(e,s){if(!this.events[e]||this.suspended)return;let n=[],i=this.events[t.ANY_EVENT]||[];return this.events[e]&&(i=i.concat(this.events[e])),i.forEach(t=>{t.suspended||(t.count>0&&(void 0!==s?n.push(t.callback.call(t.context,s,t.data)):n.push(t.callback.call(t.context,t.data))),--t.count<1&&t.remove())}),n}off(t,e,s={}){if(!t)return void(this.events={});if(!this.events[t])return;let n=this.events[t].filter(t=>e&&t.callback!==e||s.count&&s.count!==t.count||s.context&&s.context!==t.context);n.length?this.events[t]=n:delete this.events[t]}get eventCount(){return Object.keys(this.events).length}}class e{constructor(t,e,s,n={}){const i={context:this,count:1/0,data:void 0};n=Object.assign({},i,n),this.event=t,this.target=e,this.callback=s,this.context=n.context,this.count=n.count,this.data=n.data,this.suspended=!1}remove(){this.target.off(this.event,this.callback,{context:this.context,count:this.count})}}export{t as EventEmitter,e as Listener};
